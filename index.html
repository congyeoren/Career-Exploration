<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Personality &amp; Skills Sorter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&amp;display=swap"
    rel="stylesheet"
  />
  <script>
    try {
      const storageKey = "ce-theme";
      const savedTheme = localStorage.getItem(storageKey);
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
      document.documentElement.dataset.theme = savedTheme || (prefersDark ? "dark" : "light");
    } catch (err) {
      document.documentElement.dataset.theme = "light";
    }
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: [
              "Plus Jakarta Sans",
              "Inter",
              "system-ui",
              "-apple-system",
              "BlinkMacSystemFont",
              "Segoe UI",
              "sans-serif"
            ]
          }
        }
      }
    };
  </script>
  <style>
    :root {
      color-scheme: light;
      --font-sans: "Plus Jakarta Sans", "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --bg-page: #f6f7fb;
      --bg-page-alt: #eef2ff;
      --surface: rgba(255, 255, 255, 0.92);
      --surface-elevated: rgba(255, 255, 255, 0.98);
      --surface-muted: rgba(15, 23, 42, 0.06);
      --surface-hover: rgba(15, 23, 42, 0.05);
      --border-soft: rgba(15, 23, 42, 0.08);
      --border-strong: rgba(15, 23, 42, 0.16);
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-tertiary: #64748b;
      --muted: #64748b;
      --accent-600: #1d4ed8;
      --accent-500: #2563eb;
      --accent-400: #3b82f6;
      --accent-300: #60a5fa;
      --accent-soft: rgba(37, 99, 235, 0.12);
      --accent-ring: rgba(37, 99, 235, 0.35);
      --success-600: #047857;
      --success-soft: rgba(16, 185, 129, 0.12);
      --success-border: rgba(5, 150, 105, 0.28);
      --neutral-soft: rgba(148, 163, 184, 0.16);
      --neutral-border: rgba(148, 163, 184, 0.25);
      --danger-soft: rgba(239, 68, 68, 0.08);
      --danger-border: rgba(248, 113, 113, 0.25);
      --shadow-sm: 0 12px 36px rgba(15, 23, 42, 0.08);
      --shadow-md: 0 30px 70px rgba(15, 23, 42, 0.12);
      --text-on-accent: #ffffff;
    }

    [data-theme="dark"] {
      color-scheme: dark;
      --bg-page: #0b1220;
      --bg-page-alt: #141e34;
      --surface: rgba(15, 23, 42, 0.78);
      --surface-elevated: rgba(15, 23, 42, 0.92);
      --surface-muted: rgba(148, 163, 184, 0.12);
      --surface-hover: rgba(148, 163, 184, 0.18);
      --border-soft: rgba(148, 163, 184, 0.18);
      --border-strong: rgba(148, 163, 184, 0.4);
      --text-primary: #e2e8f0;
      --text-secondary: #cbd5f5;
      --text-tertiary: #94a3b8;
      --muted: #94a3b8;
      --accent-600: #60a5fa;
      --accent-500: #38bdf8;
      --accent-400: #0ea5e9;
      --accent-300: rgba(56, 189, 248, 0.6);
      --accent-soft: rgba(56, 189, 248, 0.18);
      --accent-ring: rgba(56, 189, 248, 0.45);
      --success-600: #34d399;
      --success-soft: rgba(52, 211, 153, 0.22);
      --success-border: rgba(52, 211, 153, 0.45);
      --neutral-soft: rgba(148, 163, 184, 0.18);
      --neutral-border: rgba(148, 163, 184, 0.3);
      --danger-soft: rgba(248, 113, 113, 0.18);
      --danger-border: rgba(248, 113, 113, 0.45);
      --shadow-sm: 0 20px 48px rgba(8, 15, 35, 0.6);
      --shadow-md: 0 40px 90px rgba(8, 15, 35, 0.55);
      --text-on-accent: #0b1220;
    }

    body {
      min-height: 100vh;
      font-family: var(--font-sans);
      background: radial-gradient(130% 130% at 0% 0%, var(--bg-page-alt) 0%, var(--bg-page) 55%);
      color: var(--text-primary);
      line-height: 1.6;
      transition: background 0.4s ease, color 0.3s ease;
    }

    .page-shell {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .content-width {
      width: min(1100px, 100%);
      margin-inline: auto;
    }

    header {
      padding-top: 2.75rem;
      padding-bottom: 1.25rem;
    }

    .brand-block {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .brand-mark {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 48px;
      height: 48px;
      border-radius: 16px;
      background: var(--accent-soft);
      color: var(--accent-600);
      font-weight: 700;
      letter-spacing: 0.04em;
      box-shadow: var(--shadow-sm);
    }

    .page-title {
      font-size: clamp(1.9rem, 4vw, 2.9rem);
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .eyebrow {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.24em;
      font-weight: 600;
      color: var(--accent-600);
    }

    .text-muted {
      color: var(--text-secondary);
    }

    .tab-group {
      display: inline-flex;
      align-self: flex-start;
      background: var(--surface);
      padding: 0.35rem;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      box-shadow: var(--shadow-sm);
    }

    .tab-button {
      position: relative;
      padding: 0.65rem 1.6rem;
      border-radius: 999px;
      font-weight: 600;
      font-size: 0.95rem;
      color: var(--text-tertiary);
      transition: background 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }

    .tab-button.tab-active {
      background: var(--accent-soft);
      color: var(--accent-600);
      box-shadow: inset 0 0 0 1px var(--accent-300);
    }

    .status-card {
      background: var(--surface);
      border-radius: 20px;
      border: 1px solid var(--border-soft);
      padding: 1.5rem;
      box-shadow: var(--shadow-sm);
      backdrop-filter: blur(12px);
      margin-bottom: 1.5rem;
      display: none
    }

    .progress-track {
      width: 100%;
      height: 0.65rem;
      background: var(--surface-muted);
      border-radius: 999px;
      overflow: hidden;
      position: relative;
    }

    .progress-bar {
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--accent-500), var(--accent-400));
      transition: width 0.35s ease;
    }

    .progress-text {
      margin-top: 0.75rem;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-secondary);
    }

    .grid-layout {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    /* Keep one column even on desktop so Current Trait/Skill stays above */
    @media (min-width: 960px) {
      .grid-layout {
        grid-template-columns: 1fr;
      }
    }

    .current-card {
      background: var(--surface);
      border-radius: 24px;
      border: 1px solid var(--border-soft);
      padding: 1.5rem;
      box-shadow: var(--shadow-md);
      backdrop-filter: blur(16px);
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .current-card p {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .current-title {
      font-size: 1.35rem;
      font-weight: 700;
      color: var(--text-primary);
      margin-top: 0.25rem;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.75rem;
      font-weight: 600;
      background: var(--accent-soft);
      color: var(--accent-600);
      width: fit-content;
    }

    /* Choice buttons: always stacked vertically and full width */
    .choice-group {
      display: grid;
      gap: 0.75rem;
      grid-template-columns: 1fr; /* single column at all sizes */
    }

    .choice-group > .btn {
      width: 100%;
      min-width: 0;
      white-space: normal;   /* wrap text naturally */
      word-break: keep-all;  /* avoid breaking inside words */
      text-align: center;
    }

    .btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.85rem 1.4rem;
      border-radius: 18px;
      border: 1px solid transparent;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.2s ease;
      min-height: 44px;
    }

    .btn-primary {
      background: linear-gradient(120deg, var(--accent-500), var(--accent-400));
      color: var(--text-on-accent);
      border-color: transparent;
      box-shadow: var(--shadow-sm);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      filter: brightness(1.02);
    }

    .btn-secondary {
      background: var(--surface);
      border: 1px solid var(--border-strong);
      color: var(--text-primary);
    }

    .btn-secondary:hover {
      background: var(--surface-hover);
    }

    .btn-ghost {
      background: transparent;
      border-color: transparent;
      color: var(--text-secondary);
    }

    .btn-ghost:hover {
      background: var(--surface-hover);
      color: var(--text-primary);
    }

    .btn-icon {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background: var(--surface);
      border: 1px solid var(--border-soft);
      color: var(--text-primary);
      padding: 0;
    }

    .btn-icon:hover {
      background: var(--surface-hover);
    }

    .btn-link {
      background: transparent;
      border: none;
      padding: 0;
      color: var(--accent-600);
      font-size: 0.85rem;
      font-weight: 600;
      text-decoration: none;
    }

    .btn-link:hover {
      text-decoration: underline;
    }

    .choice-btn-low {
      background: var(--neutral-soft);
      border-color: var(--neutral-border);
      color: var(--text-primary);
    }

    .choice-btn-low:hover {
      background: rgba(148, 163, 184, 0.22);
    }

    .choice-btn-mid {
      background: var(--accent-soft);
      border-color: var(--accent-300);
      color: var(--accent-600);
    }

    .choice-btn-mid:hover {
      background: rgba(37, 99, 235, 0.18);
    }

    .choice-btn-high {
      background: var(--success-soft);
      border-color: var(--success-border);
      color: var(--success-600);
    }

    .choice-btn-high:hover {
      background: rgba(16, 185, 129, 0.2);
    }

    .list-column {
      background: var(--surface);
      border-radius: 22px;
      border: 1px solid var(--border-soft);
      box-shadow: var(--shadow-sm);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      backdrop-filter: blur(12px);
    }

    .column-header {
      position: sticky;
      top: 0;
      z-index: 5;
      background: var(--surface);
      border-bottom: 1px solid var(--border-soft);
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .count-badge {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-tertiary);
    }

    .list-scroll {
      list-style: none;
      margin: 0;
      padding: 1.25rem;
      display: grid;
      gap: 0.75rem;
      overflow-y: auto;
      max-height: 420px;
    }

    .list-card {
      background: var(--surface-elevated);
      border-radius: 18px;
      border: 1px solid var(--border-soft);
      padding: 1rem;
      box-shadow: var(--shadow-sm);
      transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.3s ease;
    }

    .column-low .list-card {
      border-color: var(--neutral-border);
    }

    .column-mid .list-card {
      border-color: var(--accent-300);
      background: var(--accent-soft);
    }

    .column-high .list-card {
      border-color: var(--success-border);
      background: var(--success-soft);
    }

    .list-card:hover {
      transform: translateY(-2px);
    }

    .item-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
    }

    .item-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 1rem;
    }

    .item-description {
      margin-top: 0.55rem;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    .bottom-bar {
      margin-top: auto;
      position: sticky;
      bottom: 0;
      width: 100%;
      background: var(--surface);
      border-top: 1px solid var(--border-soft);
      box-shadow: 0 -18px 40px rgba(15, 23, 42, 0.08);
      backdrop-filter: blur(16px);
    }

    .bottom-bar-inner {
      padding: 1.2rem 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.85rem;
    }

    @media (min-width: 768px) {
      .bottom-bar-inner {
        flex-direction: row;
        align-items: center;
      }
    }

    .callout-text {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-secondary);
    }

    .item {
      transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.35s ease;
      transform: translateX(0);
      opacity: 1;
    }

    .item.removing {
      transform: translateX(-12%);
      opacity: 0;
    }

    .item.adding {
      transform: translateY(-12px);
      opacity: 0;
    }

    .item.added {
      transform: translateY(0);
      opacity: 1;
    }

    .complete-card {
      text-align: center;
      gap: 1.25rem;
    }

    .complete-card p {
      font-size: 0.95rem;
    }

    :focus-visible {
      outline: 3px solid var(--accent-ring);
      outline-offset: 3px;
      border-radius: 16px;
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--surface-muted);
      border-radius: 999px;
    }

    @media (max-width: 768px) {
      header {
        padding-top: 2.25rem;
      }

      .list-scroll {
        max-height: 300px;
      }
    }
  </style>
</head>
<body class="min-h-screen font-sans">
  <div class="page-shell">
    <header class="content-width px-4">
      <div class="flex flex-col gap-6">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
          <div class="brand-block">
            <div>
              <p class="eyebrow">Career Exploration</p>
              <h1 class="page-title">Sort Your Traits &amp; Skills</h1>
            </div>
          </div>
          <div class="flex items-center gap-3 self-start md:self-center">
            <button id="themeToggle" class="btn btn-icon" type="button" aria-label="Toggle theme"></button>
          </div>
        </div>
        <p class="text-muted max-w-2xl text-base md:text-lg">
          Place each item in the category that feels right for you. Switch between personality traits and skills at any time and fine-tune your selections before copying the final AI prompt.
        </p>
        <nav class="tab-group">
          <button id="tabTraits" class="tab-button tab-active" type="button" onclick="switchTab('traits')">Personality Traits</button>
          <button id="tabSkills" class="tab-button" type="button" onclick="switchTab('skills')">Skills</button>
        </nav>
      </div>
    </header>

    <main class="content-width px-4 pb-36 md:pb-24">
      <section id="traitsContainer" class="mt-6 md:mt-10"></section>
      <section id="skillsContainer" class="hidden mt-6 md:mt-10"></section>
    </main>

    <div class="bottom-bar">
      <div class="content-width bottom-bar-inner">
        <p class="callout-text">Ready to explore tailored career ideas? Copy your personalised AI prompt when you're finished.</p>
        <div class="flex-1"></div>
        <button onclick="copyPromptFlow()" class="btn btn-primary" type="button">
          Copy Prompt
        </button>
      </div>
    </div>
  </div>

<script>
  /********************************
   * DATA: NEW TRAITS (37)
   ********************************/
  const TRAITS = [
    { label: "Achievement-oriented", description: "Focused on setting and reaching goals" },
    { label: "Action-oriented", description: "Prefers doing over deliberating" },
    { label: "Adaptable", description: "Adjusts well to change" },
    { label: "Adventurous", description: "Willing to take risks and try new things" },
    { label: "Artistic", description: "Expresses themselves through various art forms" },
    { label: "Assertive", description: "Confident in expressing opinions and needs" },
    { label: "Composed", description: "Stays collected and in control" },
    { label: "Confident", description: "Believes in oneself and one's decisions" },
    { label: "Considerate", description: "Thinks of others' feelings and needs" },
    { label: "Creative", description: "Able to produce original and imaginative ideas" },
    { label: "Curious", description: "Eager to explore new ideas and experiences" },
    { label: "Dependable", description: "Can be counted on and trusted" },
    { label: "Disciplined", description: "Maintains control and follows routines" },
    { label: "Efficient", description: "Achieves maximum productivity with minimum waste" },
    { label: "Empathetic", description: "Understands and shares others' emotions" },
    { label: "Energetic", description: "Full of vitality and activity" },
    { label: "Enthusiastic", description: "Shows intense enjoyment and interest" },
    { label: "Expressive", description: "Openly shows thoughts and emotions" },
    { label: "Group-oriented", description: "Prefers to work with others in teams" },
    { label: "Helpful", description: "Eager to assist others" },
    { label: "Imaginative", description: "Thinks in creative and fantastical ways" },
    { label: "Innovative", description: "Skilled at introducing new methods or ideas" },
    { label: "Intellectual", description: "Engages deeply with ideas and enjoys thinking" },
    { label: "Level-headed", description: "Thinks clearly in difficult situations" },
    { label: "Optimistic", description: "Looks at the positive side of situations" },
    { label: "Organised", description: "Keeps things tidy and plans ahead" },
    { label: "Original", description: "Comes up with unique and independent ideas" },
    { label: "Patient", description: "Endures delays or problems calmly" },
    { label: "Resilient", description: "Bounces back from setbacks" },
    { label: "Responsible", description: "Reliable and accountable for actions" },
    { label: "Sociable", description: "Finds joy in social interactions" },
    { label: "Steady", description: "Reliable and unwavering" },
    { label: "Systematic", description: "Uses methodical approaches to solve problems" },
    { label: "Tactful", description: "Says or does things in a considerate way" },
    { label: "Thorough", description: "Pays attention to detail and completeness" },
    { label: "Trusting", description: "Believes in the reliability of others" },
    { label: "Versatile", description: "Adapts easily to different tasks or situations" }
  ];

  /********************************
   * DATA: NEW SKILLS (42)
   ********************************/
  const SKILLS = [
    { label: "Acting/Performance", description: "Portraying roles convincingly on stage or screen" },
    { label: "Active Listening", description: "Fully focusing on others to understand and respond thoughtfully" },
    { label: "Adaptability", description: "Adjusting smoothly to new challenges and environments" },
    { label: "Attention to Detail", description: "Ensuring accuracy by focusing on small elements" },
    { label: "Coding/Programming", description: "Writing code to develop software applications" },
    { label: "Communication (Verbal)", description: "Effectively conveying ideas and information by speaking" },
    { label: "Communication (Written)", description: "Clearly expressing ideas in writing" },
    { label: "Conflict Resolution", description: "Resolving disagreements effectively and diplomatically" },
    { label: "Cooking/Culinary Arts", description: "Preparing and experimenting with meals" },
    { label: "Creativity", description: "Developing imaginative ideas or solutions" },
    { label: "Critical Thinking", description: "Analyzing facts to form sound judgments" },
    { label: "Data Analysis", description: "Interpreting complex datasets to uncover insights" },
    { label: "Data Modelling", description: "Create models to predict an outcome" },
    { label: "Digital Marketing", description: "Promoting products and brands via digital channels" },
    { label: "Emotional Intelligence", description: "Recognizing and managing emotions in oneself and others" },
    { label: "Empathy", description: "Understanding and sharing the feelings of others" },
    { label: "Event Planning", description: "Coordinating logistics for gatherings and celebrations" },
    { label: "Financial Literacy/Budgeting", description: "Handling money and planning finances effectively" },
    { label: "Foreign Languages", description: "Communicating fluently in non-native languages" },
    { label: "Graphic Design", description: "Creating visual concepts using design principles" },
    { label: "Information Architecture", description: "Structuring, organising and labelling content to make it accessible for users" },
    { label: "Leadership", description: "Guiding and motivating a team to achieve goals" },
    { label: "Mathematics", description: "Applying numerical methods for problem-solving" },
    { label: "Mechanical Skills", description: "Understanding and repairing mechanical systems" },
    { label: "Mentoring", description: "Supporting and guiding others to develop their skills" },
    { label: "Motivation (Self & Others)", description: "Inspiring sustained enthusiasm and effort" },
    { label: "Music Composition/Performance", description: "Creating or performing musical works" },
    { label: "Networking", description: "Building professional relationships for mutual benefit" },
    { label: "Patience", description: "Remaining calm when faced with delays or challenges" },
    { label: "Persuasion", description: "Influencing others to agree or take action" },
    { label: "Photography", description: "Capturing images with artistic or technical skill" },
    { label: "Problem-Solving", description: "Identifying and resolving issues creatively" },
    { label: "Project Management", description: "Planning and overseeing projects to successful outcomes" },
    { label: "Public Speaking", description: "Delivering oral presentations with confidence" },
    { label: "Research", description: "Investigating topics thoroughly to gather information" },
    { label: "Sales", description: "Selling products or services to meet customer needs" },
    { label: "Scientific Lab Skills", description: "Conducting experiments and analyzing data in a lab" },
    { label: "Social Media Management", description: "Managing online presence across social networks" },
    { label: "Systems Thinking", description: "Ability to see the interconnectedness of systems and how different factors influence one another" },
    { label: "Teaching/Tutoring", description: "Instructing students individually or in groups" },
    { label: "Time Management", description: "Organizing time to efficiently achieve tasks" },
    { label: "Video Editing", description: "Cutting and assembling video footage into cohesive content" }
  ];

  /********************************
   * STATE
   ********************************/
  let remainingTraits = [...TRAITS], lowTraits = [], midTraits = [], highTraits = [];
  let remainingSkills = [...SKILLS], lowSkills = [], midSkills = [], highSkills = [];
  let activeTab = 'traits';

  /********************************
   * HELPERS
   ********************************/
  const qs  = (sel) => document.querySelector(sel);

  function switchTab(tab) {
    activeTab = tab;
    qs('#traitsContainer').classList.toggle('hidden', tab !== 'traits');
    qs('#skillsContainer').classList.toggle('hidden', tab !== 'skills');
    qs('#tabTraits').classList.toggle('tab-active', tab === 'traits');
    qs('#tabSkills').classList.toggle('tab-active', tab === 'skills');
  }

  function joinWithAnd(arr) {
    if (arr.length === 0) return "";
    if (arr.length === 1) return arr[0];
    if (arr.length === 2) return `${arr[0]} and ${arr[1]}`;
    return `${arr.slice(0, -1).join(", ")}, and ${arr[arr.length - 1]}`;
  }

  function percent(n, d) { return d ? Math.round((n / d) * 100) : 0; }

  function makeListItem(kind, column, item) {
    const safeId = `${kind}-${column}-${item.label.replace(/\s+/g, '-').replace(/\//g, '-')}`;
    const li = document.createElement('li');
    li.id = safeId;
    li.className = `item list-card adding`;
    li.innerHTML = `
      <div class="item-header">
        <span class="item-title">${item.label}</span>
        <button class="btn-link" type="button">Remove</button>
      </div>
      <p class="item-description">${item.description}</p>
    `;
    li.querySelector('button').addEventListener('click', () => revertItem(item.label, kind, column));
    return li;
  }

  function updateProgress(kind) {
    const total = (kind === 'traits') ? TRAITS.length : SKILLS.length;
    const done = (kind === 'traits')
      ? (lowTraits.length + midTraits.length + highTraits.length)
      : (lowSkills.length + midSkills.length + highSkills.length);

    const pct = percent(done, total);
    const bar = qs(`#${kind}-progress-bar`);
    const text = qs(`#${kind}-progress-text`);
    if (bar)  { bar.style.width = `${pct}%`; }
    if (text) { text.textContent = `${pct}% complete`; }  // percentage only

    const setCount = (id, n) => { const el = qs(id); if (el) el.textContent = `(${n})`; };
    if (kind === 'traits') {
      setCount('#traits-low-count', lowTraits.length);
      setCount('#traits-mid-count', midTraits.length);
      setCount('#traits-high-count', highTraits.length);
    } else {
      setCount('#skills-low-count', lowSkills.length);
      setCount('#skills-mid-count', midSkills.length);
      setCount('#skills-high-count', highSkills.length);
    }
  }

  function updateCurrentCard(kind) {
    const currentWrap = qs(`#${kind}-current`);
    const remaining = (kind === 'traits') ? remainingTraits : remainingSkills;
    if (!currentWrap) return;

    if (!remaining[0]) {
      const label = kind === 'traits' ? 'traits' : 'skills';
      currentWrap.innerHTML = `
        <article class="current-card complete-card">
          <div>
            <span class="chip">Complete</span>
            <p>All ${label} sorted! You can still revisit your choices below.</p>
          </div>
          <button onclick="resetAll('${kind}')" class="btn btn-secondary" type="button">Reset ${label.charAt(0).toUpperCase() + label.slice(1)}</button>
        </article>
      `;
      return;
    }

    const item = remaining[0];
    const label = kind === 'traits' ? 'Traits' : 'Skills';
    currentWrap.innerHTML = `
      <article class="current-card">
        <div>
          <span class="chip">Up next</span>
          <h2 class="current-title">${item.label}</h2>
          <p>${item.description}</p>
        </div>
        <div class="choice-group">
          <button id="${kind}-low-btn" class="btn choice-btn-low" type="button">Does not describe me well</button>
          <button id="${kind}-mid-btn" class="btn choice-btn-mid" type="button">Somewhat describes me</button>
          <button id="${kind}-high-btn" class="btn choice-btn-high" type="button">Describes me very well</button>
        </div>
        <button onclick="resetAll('${kind}')" class="btn btn-secondary w-full" type="button">Reset ${label}</button>
      </article>
    `;
    qs(`#${kind}-low-btn`).onclick  = () => rateItem(item.label, kind, 'low');
    qs(`#${kind}-mid-btn`).onclick  = () => rateItem(item.label, kind, 'mid');
    qs(`#${kind}-high-btn`).onclick = () => rateItem(item.label, kind, 'high');
  }

  function appendToList(kind, column, item) {
    const ul = qs(`#${kind}-${column}`);
    if (!ul) return;
    const li = makeListItem(kind, column, item);
    ul.appendChild(li);
    requestAnimationFrame(() => {
      li.classList.remove('adding');
      li.classList.add('added');
    });
  }

  function removeFromList(kind, column, label) {
    const safeId = `#${kind}-${column}-${label.replace(/\s+/g, '-').replace(/\//g, '-')}`;
    const li = qs(safeId);
    if (!li) return Promise.resolve();
    li.classList.add('removing');
    return new Promise((resolve) => {
      setTimeout(() => { li.remove(); resolve(); }, 350);
    });
  }

  /********************************
   * INITIAL RENDER (structure only)
   ********************************/
  function initialRender() {
    const traitsHTML = `
      <div class="status-card" style="display:none">
        <div class="progress-track">
          <div id="traits-progress-bar" class="progress-bar" style="width:0%"></div>
        </div>
        <p id="traits-progress-text" class="progress-text">0% complete</p>
      </div>

      <div class="grid-layout">
        <div>
          <h2 class="text-lg font-semibold text-muted mb-3">Current Trait</h2>
          <div id="traits-current"></div>
        </div>

        <div class="list-column column-low">
          <div class="column-header">
            <span>Does not describe me well</span>
            <span id="traits-low-count" class="count-badge">(0)</span>
          </div>
          <ul id="traits-low" class="list-scroll"></ul>
        </div>

        <div class="list-column column-mid">
          <div class="column-header">
            <span>Somewhat describes me</span>
            <span id="traits-mid-count" class="count-badge">(0)</span>
          </div>
          <ul id="traits-mid" class="list-scroll"></ul>
        </div>

        <div class="list-column column-high">
          <div class="column-header">
            <span>Describes me very well</span>
            <span id="traits-high-count" class="count-badge">(0)</span>
          </div>
          <ul id="traits-high" class="list-scroll"></ul>
        </div>
      </div>
    `;

    const skillsHTML = `
      <div class="status-card" style="display:none">
        <div class="progress-track">
          <div id="skills-progress-bar" class="progress-bar" style="width:0%"></div>
        </div>
        <p id="skills-progress-text" class="progress-text">0% complete</p>
      </div>

      <div class="grid-layout">
        <div>
          <h2 class="text-lg font-semibold text-muted mb-3">Current Skill</h2>
          <div id="skills-current"></div>
        </div>

        <div class="list-column column-low">
          <div class="column-header">
            <span>Does not describe me well</span>
            <span id="skills-low-count" class="count-badge">(0)</span>
          </div>
          <ul id="skills-low" class="list-scroll"></ul>
        </div>

        <div class="list-column column-mid">
          <div class="column-header">
            <span>Somewhat describes me</span>
            <span id="skills-mid-count" class="count-badge">(0)</span>
          </div>
        <ul id="skills-mid" class="list-scroll"></ul>
        </div>

        <div class="list-column column-high">
          <div class="column-header">
            <span>Describes me very well</span>
            <span id="skills-high-count" class="count-badge">(0)</span>
          </div>
          <ul id="skills-high" class="list-scroll"></ul>
        </div>
      </div>
    `;

    qs('#traitsContainer').innerHTML = traitsHTML;
    qs('#skillsContainer').innerHTML = skillsHTML;

    updateCurrentCard('traits');
    updateCurrentCard('skills');
    updateProgress('traits');
    updateProgress('skills');
  }

  /********************************
   * INTERACTIONS (DOM patching)
   ********************************/
  function rateItem(label, kind, bucket) {
    const sets = (kind === 'traits')
      ? { remaining: remainingTraits, low: lowTraits, mid: midTraits, high: highTraits, all: TRAITS }
      : { remaining: remainingSkills, low: lowSkills, mid: midSkills, high: highSkills, all: SKILLS };

    const current = sets.remaining[0];
    if (!current || current.label !== label) return;

    sets[bucket].push(current.label);
    sets.remaining.shift();

    appendToList(kind, bucket, current);
    updateCurrentCard(kind);
    updateProgress(kind);
  }

  function revertItem(label, kind, fromBucket) {
    const sets = (kind === 'traits')
      ? { remaining: remainingTraits, low: lowTraits, mid: midTraits, high: highTraits, all: TRAITS }
      : { remaining: remainingSkills, low: lowSkills, mid: midSkills, high: highSkills, all: SKILLS };

    removeFromList(kind, fromBucket, label).then(() => {
      const arr = sets[fromBucket];
      const idx = arr.indexOf(label);
      if (idx > -1) arr.splice(idx, 1);

      const original = sets.all.find(x => x.label === label);
      if (original) sets.remaining.push(original);

      updateCurrentCard(kind);
      updateProgress(kind);
    });
  }

  function resetAll(kind) {
    if (kind === 'traits') {
      remainingTraits = [...TRAITS];
      lowTraits = []; midTraits = []; highTraits = [];
      qs('#traits-low').innerHTML = '';
      qs('#traits-mid').innerHTML = '';
      qs('#traits-high').innerHTML = '';
      updateCurrentCard('traits');
      updateProgress('traits');
    } else {
      remainingSkills = [...SKILLS];
      lowSkills = []; midSkills = []; highSkills = [];
      qs('#skills-low').innerHTML = '';
      qs('#skills-mid').innerHTML = '';
      qs('#skills-high').innerHTML = '';
      updateCurrentCard('skills');
      updateProgress('skills');
    }
  }

  /********************************
   * PROMPT (from HIGH only, max 7 each)
   ********************************/
  function buildPrompt() {
    const pickedTraits = highTraits.slice(0, 7);
    const pickedSkills = highSkills.slice(0, 7);

    const errors = [];
    if (highTraits.length > 7) {
      errors.push(`• You currently have ${highTraits.length} traits in “Describes me very well” (limit is 7). Please remove ${highTraits.length - 7}.`);
    }
    if (highSkills.length > 7) {
      errors.push(`• You currently have ${highSkills.length} skills in “Describes me very well” (limit is 7). Please remove ${highSkills.length - 7}.`);
    }
    if (errors.length) {
      return { error: "Almost there!\n\nTo proceed, reduce your selections:\n\n" + errors.join("\n") + "\n\nTip: Tap “Remove” beside any item to move it back." };
    }

    const skillsPart = pickedSkills.length
      ? `My top ${pickedSkills.length} skill${pickedSkills.length>1?'s':''} ${pickedSkills.length===1?'is':'are'}: ${joinWithAnd(pickedSkills)}.`
      : `I haven't shortlisted any skills yet.`;

    const traitsPart = pickedTraits.length
      ? `My top ${pickedTraits.length} personality trait${pickedTraits.length>1?'s':''} ${pickedTraits.length===1?'is':'are'}: ${joinWithAnd(pickedTraits)}.`
      : `I haven't shortlisted any tab yet.`;

    const text = `I am a high school student exploring career options. ${skillsPart} ${traitsPart}

Please suggest 8–10 careers that strongly align with these skills and traits. For each career, include:
- A brief description (1–2 sentences).
- Why it fits my combination.
- Examples of industries or workplaces where this career exists.

Then, recommend 1–2 additional skills or traits I could develop to strengthen my fit for these careers.`;

    return { text };
  }

  async function copyToClipboard(text) {
    if (navigator.clipboard && window.isSecureContext) {
      try { await navigator.clipboard.writeText(text); return true; }
      catch { /* fallthrough */ }
    }
    const ta = document.createElement("textarea");
    ta.value = text;
    ta.style.position = "fixed";
    ta.style.top = "-9999px";
    ta.style.left = "-9999px";
    document.body.appendChild(ta);
    ta.focus();
    ta.select();
    let ok = false;
    try { ok = document.execCommand("copy"); } catch { ok = false; }
    document.body.removeChild(ta);
    return ok;
  }

  async function copyPromptFlow() {
    const result = buildPrompt();
    if (result.error) {
      alert(result.error);
      return;
    }
    const ok = await copyToClipboard(result.text);
    alert(ok ? "Prompt copied to clipboard. Paste it into your AI tool." : "Copy failed. Please select all and copy manually.");
  }

  function setupThemeToggle() {
    const toggleBtn = qs('#themeToggle');
    if (!toggleBtn) return;
    const storageKey = 'ce-theme';
    const root = document.documentElement;
    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');

    function setButtonIcon(theme) {
      toggleBtn.innerHTML = theme === 'dark'
        ? `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M21 12.79A9 9 0 0 1 11.21 3 7 7 0 0 0 12 17a7 7 0 0 0 9-4.21Z" /></svg>`
        : `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="5" /><path d="M12 1v2m0 18v2m11-11h-2M3 12H1m19.07 7.07-1.41-1.41M6.34 6.34 4.93 4.93m12.02 0 1.41 1.41M6.34 17.66l-1.41 1.41" /></svg>`;
      toggleBtn.setAttribute('aria-label', theme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode');
    }

    function applyTheme(theme, persist = false) {
      root.dataset.theme = theme;
      setButtonIcon(theme);
      if (persist) {
        try { localStorage.setItem(storageKey, theme); } catch (err) { /* ignore */ }
      }
    }

    const storedTheme = (() => {
      try { return localStorage.getItem(storageKey); } catch (err) { return null; }
    })();
    const initialTheme = root.dataset.theme || storedTheme || (mediaQuery.matches ? 'dark' : 'light');
    applyTheme(initialTheme);

    toggleBtn.addEventListener('click', () => {
      const nextTheme = root.dataset.theme === 'dark' ? 'light' : 'dark';
      applyTheme(nextTheme, true);
    });

    mediaQuery.addEventListener('change', (event) => {
      const hasStored = (() => {
        try { return localStorage.getItem(storageKey) !== null; } catch (err) { return false; }
      })();
      if (hasStored) return;
      applyTheme(event.matches ? 'dark' : 'light');
    });
  }

  /********************************
   * BOOT
   ********************************/
  function initialRenderWrappers() {
    initialRender();
    updateCurrentCard('traits');
    updateCurrentCard('skills');
    updateProgress('traits');
    updateProgress('skills');
  }
  initialRenderWrappers();
  switchTab('traits');
  setupThemeToggle();
</script>
</body>
</html>
